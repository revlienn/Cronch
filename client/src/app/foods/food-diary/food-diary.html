<h1>FOOD DIARY</h1>

@if(dates().length){
<div class="grid 
   lg:grid-cols-3 lg:gap-5 
   md:grid-cols-2 md:gap-y-2 md:gap-x-4">
   @for(date of dates();track $index){
   <div class=" flex flex-col mb-3 rounded-t-xl shadow-xl ">
      <div class="flex flex-col justify-between rounded-t-lg bg-gradient-to-r from-red-200 to-rose-100 px-4 py-2">
         <div class="flex-col">
            <div class="flex justify-between pb-0 mb-0 leading-0">
               <span class="text-lg font-semibold">{{ date }}</span>

               @if(editingDate()!==date){<div class="flex align-middle text-sm"><button
                     class="align-baseline italic hover:font-bold" (click)="editDiaryCard(date)">
                     Edit</button></div>}
               @else{
               <div class="flex align-middle text-sm"><button class="align-baseline italic hover:font-bold"
                     (click)="editDiaryCard(date)">
                     Save</button></div>
               }
            </div>
            <div class="mt-0 pt-0 leading-0">
               <span class="text-sm font-semibold text-rose-600 italic pe-2">{{ dailyTotals()[date]?.calories
                  }}cal</span>
               <span class="text-sm font-semibold text-blue-600 italic">{{ dailyTotals()[date]?.protein }}g
                  protein</span>
            </div>
         </div>
      </div>
      <div class="px-3 py-2 h-full shadow-lg/10">
         @for(item of foodTimeGrouped()[date];track $index){
         <div class="flex justify-between border-b-1 border-gray-200 last:border-b-0 py-1">
            <div class="flex-col items-center">
               <div class="flex"><span class="text-md">{{ item.name }}</span>
                  <span class="italic ps-2  text-gray-500 ">x{{item.quantity}}</span>
               </div>
               <div class="flex gap-2 text-sm">
                  <span class="text-rose-600 italic">{{ item.calories * item.quantity }}cal</span>
                  <span class="text-blue-500 italic">{{ item.protein ? item.protein * item.quantity : 0 }}gr</span>
               </div>
            </div>
            @if(editingDate()===date){
               <div class="ps-3 flex items-center">
                  <button
                     class="bg-transparent font-bold border-1 border-gray-300 hover:border-gray-400 w-[1.5rem] h-[2rem] text-center"
                     type="button" (click)="foodService.adjustDiaryItemQty(item.id,item.quantity-1)">-</button>
                  <input type="text"
                     class="text-center w-[2rem] h-[2rem] bg-white  border-1 border-gray-300 hover:border-gray-400"
                     [value]="item.quantity" aria-label="item quantity input">
                  <button
                     class="bg-transparent font-bold border-1 border-gray-300 hover:border-gray-400 w-[1.5rem] h-[2rem] text-center"
                     type="button" (click)="foodService.adjustDiaryItemQty(item.id,item.quantity+1)">+</button>
               </div>
               }
         </div>
         }
      </div>
   </div>
   }
</div>
}@else{
<span>Nothing to see</span>
}